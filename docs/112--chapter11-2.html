
  <!DOCTYPE html>
  <html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11.2. ç©ºæ ¼ï¼šä»å¿…é¡»åˆ°æ— è§† - èµ°å‡ºC++è°œäº‘</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <script>
      window.MathJax = {"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]],"processEscapes":true,"tags":"ams"},"svg":{"fontCache":"global"}};
    </script>
    
  </head>
  <body>
    <div class="container">
      
        <div class="chapter-container">
          
  <div class="navigation">
    <a href="111-cc-chapter11-1.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š11.1. Cä¸C++çš„å…¼å®¹æ–¹å‘</a>
    <a href="113-auto-chapter11-3.html" class="next-link">ä¸‹ä¸€ç« ï¼š11.3. autoçš„æƒŠå–œ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
          <section id="112--chapter11-2" class="section">
            <h2 class="section-title">11.2. ç©ºæ ¼ï¼šä»å¿…é¡»åˆ°æ— è§†</h2>
            <p>ä»¥ä¸‹ä»£ç æ®µå¹¶ï¥§æ˜¯ä¸€ä¸ªç‰¹åˆ«å¤æ‚çš„ä»£ç æ®µï¼š</p>

<pre><code class="language-cpp">#include &lt;cstdio&gt;
#define STR_I(x) #x
#define STR(x) STR_I(x)
#define JOIN(x,y) (x y)
#define Hello(x) HELLO
int main(void){
  printf(&quot;
  printf(&quot;
}</code></pre>

<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ç³»åˆ—ç”¨äºæ“ä½œå­—ç¬¦ä¸²å’Œæ‹¼æ¥æ ‡è®°çš„å®ï¼Œå…¶é€»è¾‘å¹¶ä¸å¤æ‚ï¼š</p>

<ul>
    <li>STR&#95;I(x) å°†å…¶å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼ï¼Œ
  
  </li>  <li>STR(x) ç¡®ä¿åœ¨å­—ç¬¦ä¸²åŒ–å‰å®Œæˆå®Œæ•´çš„å®å±•å¼€ï¼Œ
  
  </li>  <li>JOIN(x,y) ç”¨ç©ºæ ¼è¿æ¥ä¸¤ä¸ªå‚æ•°ï¼Œ
  
  </li>  <li>è€Œ Hello(x) è™½ç„¶å®šä¹‰äº†ä½†æœªä½¿ç”¨ã€‚
</ul>

<p>éšåå‡ºç°äº†è¿™ä¸ªç®€çŸ­ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„ä¸¤ä¸ªprintfè°ƒç”¨ã€‚åœ¨ç¬¬ä¸€ä¸ªprintfè°ƒç”¨ä¸­ï¼ŒJOIN(Hello, World)ä¼šå…ˆå±•å¼€ä¸º(Hello World)ï¼Œç„¶åå­—ç¬¦ä¸²åŒ–ä¸º"(Hello World)"ã€‚è¿™å¹¶ä¸ç‰¹åˆ«å¤æ‚ã€‚</p>

<p>ç„¶è€Œæœ‰è¶£çš„éƒ¨åˆ†æ¥äº†ï¼šåœ¨ç¬¬äºŒä¸ªprintfè°ƒç”¨ä¸­ï¼ŒJOIN(Hello,World)(é€—å·å’ŒWorldä¹‹é—´æ²¡æœ‰ç©ºæ ¼)çš„è¡Œä¸ºä¼šæ ¹æ®GCCç‰ˆæœ¬è€Œä¸åŒï¼š</p>

<ul>
  </li>  <li>åœ¨GCC 9.4åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œç»“æœä¸ºæ²¡æœ‰ç©ºæ ¼çš„(HelloWorld)
  
  </li>  <li>è€Œåœ¨GCC 9.5åŠæ›´æ–°ç‰ˆæœ¬ä¸­ï¼Œé¢„å¤„ç†å™¨ä¼šåœ¨æ ‡è®°é—´æ·»åŠ ç©ºæ ¼ï¼Œä½¿å¾—ä¸¤ä¸ªprintfè°ƒç”¨éƒ½è¾“å‡º"(Hello World)"
</ul>

<p>GCC 9.4å’Œ9.5ä¹‹é—´çš„è¿™ç§å·®å¼‚æºäºå„ç‰ˆæœ¬å¤„ç†æ ‡è®°è¿æ¥å’Œå®å‚æ•°é—´ç©ºæ ¼çš„æ–¹å¼ä¸åŒï¼š</p>

<ul>
  </li>  <li>GCC 9.4ä¸ä¼šåœ¨æ²¡æœ‰æ˜¾å¼ç»™å‡ºç©ºæ ¼çš„åœ°æ–¹æ’å…¥ç©ºæ ¼
  
  </li>  <li>GCC 9.5åˆ™é€šè¿‡å³ä½¿åœ¨å®è°ƒç”¨ä¸­çœç•¥ç©ºæ ¼ä¹Ÿæ·»åŠ ç©ºæ ¼çš„æ–¹å¼ï¼Œä½¿å¤„ç†æ›´åŠ ä¸€è‡´
</ul>

<p>è™½ç„¶Cå’ŒC++æ ‡å‡†æ²¡æœ‰æ˜ç¡®è¯´æ˜"å®å‚æ•°å’Œé€—å·ä¹‹é—´çš„ç©ºæ ¼åº”è¢«å¿½ç•¥"ï¼Œä½†é¢„å¤„ç†å™¨çš„æ ‡è®°åŒ–å’Œå®å±•å¼€æ–¹å¼æš—ç¤ºäº†è¿™ä¸€ç‚¹ã€‚æ— è®ºå¦‚ä½•ï¼Œè§„åˆ™æŒ‡å‡ºå‚æ•°ç”±é€—å·åˆ†éš”ï¼Œè€Œç©ºæ ¼ä¸ä¼šå½±å“è¿™ç§åˆ†éš”ã€‚çœ‹èµ·æ¥GCC(9.4ä¹‹å‰ç‰ˆæœ¬)å¯¹è§„èŒƒç¼ºå¤±éƒ¨åˆ†çš„è§£é‡Šè¾ƒä¸ºå®½æ¾ï¼Œè€Œåœ¨GCC 9.5åŠä¹‹åç‰ˆæœ¬ä¸­é‡æ–°è¿›è¡Œäº†è§£é‡Šã€‚</p>

<p>ä¸ªè¯¯è§£çš„æ ¹æºåœ¨äºHelloå®è¢«å®šä¹‰æˆå‡½æ•°å¼å®ï¼Œå´è¢«å½“ä½œæ™®é€šæ›¿æ¢å®æ¥ä½¿ç”¨ã€‚å¾ˆå¯èƒ½è¿™ä¸»è¦æ˜¯ä¸ª(æˆ–è€…è¯´æ›¾ç»æ˜¯)æ—§ç‰ˆGCCçš„bugã€‚å½“ç„¶ç°åœ¨éƒ½ä¸å†ç”¨æ—§ç‰ˆæœ¬äº†ï¼Œæ¯•ç«Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œæ–°ç¼–è¯‘å™¨å¯¹æ ‡å‡†çš„éµå¾ªåº¦æ›´é«˜ï¼Œè€Œä¸”æˆ‘ä»¬å†™çš„è‚¯å®šéƒ½æ˜¯å®Œå…¨ç¬¦åˆæ ‡å‡†çš„ä»£ç ï¼Œå¯¹å§ï¼Ÿ</p>

<p>è¿™æ®µå†å²å‘å‰å…¼å®¹çš„å°æ’æ›²ç€å®æœ‰è¶£ã€‚</p>

<h4>11.1.2 ç¬¬åä¸€ä¸ªâ€œæ ‡å‡†â€</h4>

<p>C++11 åœ¨ä¿æŒä¸ C++98 å‘åå…¼å®¹çš„åŒæ—¶ï¼Œå¼•å…¥äº†ä¸€ç³»åˆ—æ–°ç‰¹æ€§ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿé€æ­¥é‡‡ç”¨ç°ä»£è¯­è¨€åŠŸèƒ½ï¼Œè€Œä¸å¿…æ‹…å¿ƒç ´åç°æœ‰ä»£ç ã€‚è¿™ä¸€è®¾è®¡å“²å­¦ç¡®ä¿äº†è¯­è¨€çš„å¹³æ»‘æ¼”è¿›ã€‚</p>

<p>å…¶ä¸­æœ€å…·é©å‘½æ€§çš„æ–°å¢ç‰¹æ€§ä¹‹ä¸€æ˜¯ ç§»åŠ¨è¯­ä¹‰ã€‚å®ƒä¸ä»…æå‡äº†æ€§èƒ½ï¼Œè¿˜å¸¦æ¥äº†å…¨æ–°çš„ç¼–ç¨‹èŒƒå¼ã€‚ç„¶è€Œï¼Œè¿™ç§ç‰¹æ€§ä¾èµ–äºä¸€ç§ C++98 ç¼–è¯‘å™¨æ— æ³•ç†è§£çš„æ–°è¯­æ³• â€”â€” å³å€¼å¼•ç”¨ï¼Œä½¿ç”¨äº†ç§»åŠ¨è¯­ä¹‰çš„ä»£ç åœ¨æ—§ç¼–è¯‘å™¨ä¸Šå°†å®Œå…¨æ— æ³•ç¼–è¯‘ï¼Œå°½ç®¡å®ƒä»¬åœ¨æ–°æ ‡å‡†ä¸­å·²æˆä¸ºæ ¸å¿ƒæœºåˆ¶ã€‚</p>

<p>åŒæ ·åœ°ï¼Œautoå…³é”®å­—é€šè¿‡è‡ªåŠ¨ç±»å‹æ¨æ–­ç®€åŒ–äº†ç±»å‹å£°æ˜ï¼Œä½†å¼€å‘è€…ä»å¯åƒåœ¨C++98ä¸­é‚£æ ·ï¼Œç”¨å®ƒæ˜¾å¼æŒ‡å®šå˜é‡å…·æœ‰è‡ªåŠ¨å­˜å‚¨ç±»å‹(è™½ç„¶è€å®è¯´ï¼Œä»æ¥æ²¡äººæŒ‰Cè¯­è¨€çš„åˆè¡·ä½¿ç”¨è¿‡è¿™ä¸ªå…³é”®å­— â€”â€” å°½ç®¡C++ç»§æ‰¿äº†å®ƒï¼Œä½†å³ä¾¿åœ¨Cè¯­è¨€ä¸­å®ƒä¹Ÿæ˜¯å¤šä½™çš„ï¼Œé™¤éè¿½æº¯åˆ°å…¶èµ·æºçš„Bè¯­è¨€æ—¶ä»£ï¼Œé‚£æ—¶å®ƒç¡®å®ç”¨äºæ­£ç¡®è¡¨ç¤ºå˜é‡çš„æ ˆå­˜å‚¨ä½ç½®)ã€‚</p>

<p>åŸºäºèŒƒå›´çš„forå¾ªç¯ç­‰æ–°è¯­æ³•ä½¿å®¹å™¨è¿­ä»£æ›´ç®€æ´ï¼Œä¸è¿‡è°¢å¤©è°¢åœ°ï¼Œç»å…¸çš„C++98é£æ ¼forå¾ªç¯ä¾ç„¶å®Œå…¨å¯ç”¨(æ¯•ç«Ÿä»æœ‰å¤§é‡ä»£ç åœ¨ä½¿ç”¨å®ƒä»¬)ã€‚nullptrçš„å¼•å…¥ä¸ºæ—§çš„NULLå®æä¾›äº†ç±»å‹å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆï¼Œä½†å‡ºäºå‘åå…¼å®¹è€ƒè™‘ï¼ŒNULLä»è¢«ä¿ç•™ â€”â€” å°½ç®¡å®ƒæœ¬è´¨ä¸Šä¸0å¹¶æ— åŒºåˆ«ã€‚</p>

<p>é™¤æ ¸å¿ƒè¯­è¨€æ”¹è¿›å¤–ï¼ŒC++11è¿˜å¼•å…¥äº†ç°ä»£å‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§ï¼Œå¦‚å…è®¸å†…è”ç¼–å†™åŒ¿åå‡½æ•°çš„lambdaè¡¨è¾¾å¼ï¼Œè®©ä»£ç æ›´ç®€æ´ä¼˜é›…ã€‚æ–°çš„constexprç‰¹æ€§ä½¿æŸäº›å‡½æ•°èƒ½åœ¨ç¼–è¯‘æœŸæ±‚å€¼ä»¥æå‡æ€§èƒ½ï¼Œä½†å¯¹äºæ—§ç¼–è¯‘å™¨ï¼Œå¼€å‘è€…ä»å¯æ²¿ç”¨C++98é‚£å¥—é€šè¿‡å¤æ‚æ¨¡æ¿é€’å½’å®ç°è¿è¡Œæ—¶å‡½æ•°æ±‚å€¼çš„è€æ–¹æ³•(æ¯•ç«Ÿæ—§ç¼–è¯‘å™¨ä¹Ÿä¸æ”¯æŒconstexpr)ã€‚</p>

<p>ç„¶è€Œï¼Œå¯¹C++è€ç”¨æˆ·è€Œè¨€ï¼Œæœ€ä»¤äººå›°æƒ‘çš„è«è¿‡äºæ¨¡æ¿è§£æè§„åˆ™ä¸­åŒå³å°–æ‹¬å·>{}>çš„å˜åŒ–ã€‚åœ¨C++98ä¸­ï¼Œå½“ä½¿ç”¨åµŒå¥—æ¨¡æ¿å‚æ•°æ—¶ï¼Œè§£æå™¨è¦æ±‚å³å°–æ‹¬å·ä¹‹é—´å¿…é¡»åŠ ç©ºæ ¼(> >)ï¼Œä»¥åŒºåˆ«äºä½ç§»è¿ç®—ç¬¦>{}> â€”â€” å› ä¸ºC++98è§£æå™¨ä¼šå°†è¿ç»­çš„ä¸¤ä¸ª>è§†ä¸ºå³ç§»è¿ç®—ç¬¦ï¼Œè€Œéä¸¤ä¸ªåµŒå¥—æ¨¡æ¿çš„é—­åˆç¬¦å·ã€‚</p>

<p>ä»C++11å¼€å§‹ï¼Œç¼–è¯‘å™¨å·²èƒ½æ™ºèƒ½è¯†åˆ«ä¸Šä¸‹æ–‡ï¼Œå°†>{}>è§†ä¸ºä¸¤ä¸ªåµŒå¥—æ¨¡æ¿çš„é—­åˆç¬¦è€Œéå³ç§»æ“ä½œã€‚è¿™ä¸ä»…ä½¿è¯­æ³•æ›´ç®€æ´ï¼Œä¹Ÿå‡å°‘äº†é”™è¯¯ç‡ï¼Œå¼€å‘è€…ä¸å†éœ€è¦æ‰‹åŠ¨æ·»åŠ ç©ºæ ¼ã€‚ä½†è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¸‹é¢è¿™æ®µç¨‹åºåœ¨ä¸åŒæ ‡å‡†ä¸‹ä¼šè¾“å‡ºä¸åŒç»“æœ(å–å†³äºä½¿ç”¨æ”¯æŒC++11çš„ç¼–è¯‘å™¨è¿˜æ˜¯ä»…æ”¯æŒC++98çš„ç¼–è¯‘å™¨)ï¼š</p>

</li><pre><code class="language-cpp">#include &lt;iostream&gt;
const int value = 1;
template &lt;class T&gt;
struct D {
  operator bool() {return true;}
  static const int value = 2;
};
template&lt;int t&gt; struct C {
  typedef int value ;
};
int main() {
  const int x = 1;
  if(D&lt;C&lt; ::value&gt;&gt;::value&gt;::value&gt;::value) {
    std::cout &lt;&lt; &quot;C++98 compiler&quot;;
  } else {
    std::cout &lt;&lt; &quot;C++11 compiler&quot;;
  }
}</code></pre>

<p>å½“æˆ‘ä»¬æ·±å…¥å‰–æè¿™æ®µç¨‹åºçš„ç²¾å¦™ä¹‹å¤„æ—¶ï¼Œå…¶æ€ªå¼‚è¡Œä¸ºçš„æˆå› å°±ä¸€ç›®äº†ç„¶äº†ã€‚å¦‚æœè¿˜æ²¡æ˜ç™½ï¼Œè®©æˆ‘ä»¬æ‹†è§£çœ‹çœ‹ã€‚ä¸è¿‡åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¸ä¼šé€è¡Œè§£ææ•´ä¸ªç¨‹åº(é‚£å¤ªå†—é•¿äº†)ï¼Œè€Œæ˜¯èšç„¦æœ€å…³é”®çš„éƒ¨åˆ†ï¼š<code><C< ::value>>::value>::value>::value</code>ï¼Œè¿™ä¸ªç»“æ„æ­£æ˜¯æ‰€æœ‰ç‰¹æ€§è¯†åˆ«çš„æ ¸å¿ƒå¯†é’¥ã€‚</p>

<p>åœ¨C++98è¯­æ³•ä¸‹ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¼šè§£æä¸ºï¼š</p>

<pre><code class="language-cpp">if(static_cast&lt;bool&gt;(D&lt;int&gt;::value)) { ... }</code></pre>

<p>å½’æ ¹ç»“åº•ï¼Œè¿™ä¸€åˆ‡éƒ½å–å†³äºD<int>::valueçš„å€¼ â€”â€” å› ä¸ºåœ¨C++98è§£æè§„åˆ™ä¸‹ï¼Œ::value>{}>::valueä¼šè§£æä¸º1 >{}> 1(ç»“æœä¸º0)ï¼Œè¿›è€Œæ¨å¯¼å‡ºC<0>::value(å³æ™®é€šçš„intç±»å‹åˆ«å)ï¼Œæœ€ç»ˆå¾—åˆ°D<int>::valueã€‚æ—¢ç„¶æˆ‘ä»¬å·²å°†å…¶å®šä¹‰ä¸º2ï¼Œç¨‹åºè‡ªç„¶ä¼šæ‰§è¡ŒC++98çš„è¯†åˆ«åˆ†æ”¯ã€‚</p>

<p>ä½†å½“ä½¿ç”¨ç¬¦åˆC++11æ ‡å‡†çš„ç¼–è¯‘å™¨è§£ææ—¶ï¼Œè¯¥è¡¨è¾¾å¼ä¼šè§£æä¸ºæ›´å¤æ‚çš„ç»“æ„ï¼š</p>

<pre><code class="language-cpp">if((static_cast&lt;int&gt;(D&lt;C&lt;1&gt; &gt;::value &gt; ::value)) &gt; ::value) { ... }</code></pre>

<p>è¿™æ®µçœ‹ä¼¼å¤æ‚çš„å¤šå±‚å³å°–æ‹¬å·ç»“æ„ï¼Œæœ€ç»ˆç«Ÿä¼šè¢«è§£æä¸ºä¸¤ä¸ªæ¯”è¾ƒè¿ç®—ï¼Œè¿™å¯èƒ½å¹¶ä¸ç›´è§‚ã€‚å…³é”®åœ¨äºD<C<1>{}>::valueçš„æ±‚å€¼ç»“æœï¼šç”±äºC<1>æœ¬èº«å°±æ˜¯ä¸€ä¸ªç±»å‹ï¼Œæˆ‘ä»¬å®é™…ä¸Šè¿›å…¥äº†ä»¥C<1>ä¸ºæ¨¡æ¿å‚æ•°çš„Dç±»ç‰¹åŒ–ç‰ˆæœ¬ï¼Œå…¶å€¼ä¸º2ã€‚æ¥ç€ä¸::value(å€¼ä¸º1)æ¯”è¾ƒï¼Œç»è¿‡ä¸€ç³»åˆ—æœ‰è¶£çš„è½¬æ¢åï¼Œæœ€ç»ˆè¡¨è¾¾å¼å®é™…ä¸Šæ˜¯1>1ï¼Œç»“æœä¸ºfalseï¼Œäºæ˜¯ç¨‹åºè¿›å…¥C++11åˆ†æ”¯ã€‚</p>

<p>è™½ç„¶æˆ‘ä»¬ç”±æ­¤è·å¾—äº†ä¸€ç§ç®€çŸ­(å°½ç®¡è¿‡åº¦å¤æ‚ä¸”ä¸å®ç”¨)çš„æ£€æµ‹æ–¹æ³•ï¼Œèƒ½åˆ¤æ–­ä»£ç æ˜¯å¦ç”±ç¬¦åˆC++11æ ‡å‡†çš„ç¼–è¯‘å™¨ç¼–è¯‘ã€‚ä½†åœ¨å®é™…ç”Ÿäº§ä»£ç ä¸­ï¼Œç›´æ¥æ£€æŸ¥<code>__cplusplus</code>å®çš„å€¼æ‰æ˜¯æ›´æ˜æ™ºçš„é€‰æ‹©ã€‚</p>
          </section>
          
  <div class="navigation">
    <a href="111-cc-chapter11-1.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š11.1. Cä¸C++çš„å…¼å®¹æ–¹å‘</a>
    <a href="113-auto-chapter11-3.html" class="next-link">ä¸‹ä¸€ç« ï¼š11.3. autoçš„æƒŠå–œ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
        </div>
        
    </div>
    
    <!-- å…ˆåŠ è½½æ ¸å¿ƒåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- åŠ è½½MathJax -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>
    
    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // åˆ›å»ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      const themeToggle = document.createElement('button');
      themeToggle.className = 'theme-toggle';
      themeToggle.setAttribute('aria-label', 'åˆ‡æ¢ä¸»é¢˜');
      themeToggle.innerHTML = 'ğŸŒ“';
      document.body.appendChild(themeToggle);
      
      // æ·»åŠ æ·±è‰²å’Œæµ…è‰²ä¸»é¢˜çš„æ ·å¼
      const darkThemeStyle = document.createElement('style');
      const lightThemeStyle = document.createElement('style');
      
      darkThemeStyle.textContent = `
        body.dark-theme {
          --background-color: #1a1a1a;
          --text-color: #e6e6e6;
          --code-bg-color: #2d2d2d;
          --link-color: #58a6ff;
          --highlight-color: #58a6ff;
          --border-color: #333;
          --table-border-color: #444;
          --table-header-bg: #2d2d2d;
          --blockquote-color: #aaa;
          --blockquote-border: #444;
          --part-header-bg: #222;
          --footer-text-color: #aaa;
          --filename-bg: #2d2d2d;
          --nav-bg: #2d2d2d;
          --nav-hover-bg: #444;
          --toc-bg: #222;
          --highlight-section-bg: #2d2d2d;
          --highlight-section-border: #58a6ff;
        }
      `;
      
      lightThemeStyle.textContent = `
        body.light-theme {
          --background-color: #ffffff;
          --text-color: #333333;
          --code-bg-color: #f5f5f5;
          --link-color: #0366d6;
          --highlight-color: #0366d6;
          --border-color: #eee;
          --table-border-color: #ddd;
          --table-header-bg: #f2f2f2;
          --blockquote-color: #666;
          --blockquote-border: #ddd;
          --part-header-bg: #f8f8f8;
          --footer-text-color: #666;
          --filename-bg: #f5f5f5;
          --nav-bg: #f5f5f5;
          --nav-hover-bg: #e6e6e6;
          --toc-bg: #f8f8f8;
          --highlight-section-bg: #f8f8f8;
          --highlight-section-border: #0366d6;
        }
      `;
      
      document.head.appendChild(darkThemeStyle);
      document.head.appendChild(lightThemeStyle);
      
      // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è®¾ç½®
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      const currentTheme = localStorage.getItem('theme');
      
      if (currentTheme === 'dark') {
        document.body.classList.add('dark-theme');
      } else if (currentTheme === 'light') {
        document.body.classList.add('light-theme');
      } else {
        // å¦‚æœæ²¡æœ‰ä¿å­˜çš„åå¥½ï¼Œè·Ÿéšç³»ç»Ÿ
        if (prefersDarkScheme.matches) {
          document.body.classList.add('dark-theme');
        } else {
          document.body.classList.add('light-theme');
        }
      }
      
      // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
      themeToggle.addEventListener('click', function() {
        console.log('Theme toggle clicked');
        if (document.body.classList.contains('dark-theme')) {
          document.body.classList.remove('dark-theme');
          document.body.classList.add('light-theme');
          localStorage.setItem('theme', 'light');
        } else {
          document.body.classList.remove('light-theme');
          document.body.classList.add('dark-theme');
          localStorage.setItem('theme', 'dark');
        }
      });
      
      // ç¡®ä¿ä»£ç å—æœ‰æ­£ç¡®çš„ç±»å
      document.querySelectorAll('pre code').forEach(function(block) {
        if (!block.className && block.parentNode.innerHTML.includes('cpp')) {
          block.className = 'language-cpp';
        } else if (!block.className && block.parentNode.innerHTML.includes('rust')) {
          block.className = 'language-rust';
        } else if (!block.className) {
          block.className = 'language-plaintext';
        }
      });
      
      // å»¶è¿ŸåŠ è½½Prismé«˜äº®
      setTimeout(function() {
        if (window.Prism) {
          window.Prism.highlightAll();
        }
      }, 500);
    });
    </script>
  </body>
  </html>
  