
  <!DOCTYPE html>
  <html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7.5. Actoræ¨¡å‹ - èµ°å‡ºC++è°œäº‘</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <script>
      window.MathJax = {"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]],"processEscapes":true,"tags":"ams"},"svg":{"fontCache":"global"}};
    </script>
    
  </head>
  <body>
    <div class="container">
      
        <div class="chapter-container">
          
  <div class="navigation">
    <a href="74--chapter7-4.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š7.4. å‡½æ•°å¼ç¼–ç¨‹çš„æ•‘æ´</a>
    <a href="76--chapter7-6.html" class="next-link">ä¸‹ä¸€ç« ï¼š7.6. æˆ‘ä»¬çš„èƒ½åŠ›è¾¹ç•Œ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
          <section id="75-actor-chapter7-5" class="section">
            <h2 class="section-title">7.5. Actoræ¨¡å‹</h2>
            <p>æˆ‘ä»¬æ‰€å¤„çš„ä¸–ç•Œæœ¬è´¨ä¸Šæ˜¯ä»¥å¹¶è¡Œæ–¹å¼è¿ä½œçš„ã€‚æ¯ä¸€æ£µæ ‘ã€æ¯ä¸€æ ªæ¤ç‰©ï¼Œä¹ƒè‡³æ¯ä¸€ä¸ªäººéƒ½åœ¨ç‹¬ç«‹åœ°è¿è¡Œå’Œå˜åŒ–ï¼Œå¶å°”é€šè¿‡ç›¸äº’ä½œç”¨æ¥å½±å“å½¼æ­¤çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¤©ç”Ÿå°±å…·å¤‡ç†è§£å¹¶è¡Œç¨‹åºè¿ä½œçš„å¿ƒæ™ºæ¨¡å‹ï¼šåœ¨ä¸€ä¸ªå…·å¤‡åŒæ­¥æœºåˆ¶çš„åŸºç¡€è®¾æ–½ä¹‹ä¸Šï¼Œå„è‡ªç‹¬ç«‹å°è£…çš„è¡Œä¸ºå®ä½“é€šè¿‡æŸç§æ–¹å¼è¿›è¡Œäº¤äº’ã€‚</p>

<p>è¿™ä¸€ç†å¿µå¯å‘äº† Carl Hewitt äº 1973 å¹´æå‡º Actor æ¨¡å‹ï¼ˆActor Modelï¼‰ã€‚è¯¥æ¨¡å‹å°†ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªèƒ½å¤Ÿæ‰§è¡Œä»¥ä¸‹ä¸‰ç§åŸºæœ¬è¡Œä¸ºçš„â€œactorâ€</p>

<ul>
    <li>å‘å…¶ä»–actorå‘é€æ¶ˆæ¯
  
  </li>  <li>åˆ›å»ºæ–°actor
  
  </li>  <li>å®šä¹‰å¤„ç†ä¸‹ä¸€æ¡æ¶ˆæ¯æ—¶åº”é‡‡å–çš„è¡Œä¸ºå‡†åˆ™
</ul>

<p>æ¯ä¸ª actor éƒ½æ‹¥æœ‰ä¸€ä¸ªç±»ä¼¼ç”µå­é‚®ä»¶åœ°å€çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå®ƒåªèƒ½ä¸è‡ªå·±å·²çŸ¥åœ°å€çš„ actor è¿›è¡Œé€šä¿¡ã€‚è¿™äº›åœ°å€é€šå¸¸é€šè¿‡æ¥æ”¶æ¶ˆæ¯æˆ–åˆ›å»ºæ–° actor çš„è¿‡ç¨‹è·å¾—ã€‚</p>

<p>Actor æ¨¡å‹çš„ä¸€ä¸ªæ ¸å¿ƒä¼˜åŠ¿åœ¨äº â€”â€” å®ƒå°†é€šä¿¡æœºåˆ¶ä¸ä¸šåŠ¡é€»è¾‘è¿›è¡Œäº†æ¸…æ™°çš„è§£è€¦ã€‚è¿™ç§è®¾è®¡ä½¿å¾—å¼€å‘è€…æ— éœ€ç›´æ¥æ“ä½œçº¿ç¨‹åŸè¯­ï¼Œå°±èƒ½ç¼–å†™å‡ºé«˜åº¦å¹¶å‘ä¸”å¯æ‰©å±•çš„ç¨‹åºã€‚</p>

<p>åœ¨ C++ ç¤¾åŒºä¸­ï¼Œæœ€æˆç†Ÿå’Œç¨³å®šçš„ Actor æ¨¡å‹å®ç°æ˜¯ CAFï¼ˆC++ Actor Frameworkï¼‰(<a href="https://www.actor-framework.org/" target="_blank" rel="noopener noreferrer">https://www.actor-framework.org/</a>)ã€‚è¿‘å¹´æ¥ä¹Ÿå‡ºç°äº†æ–°çš„å®ç°æ–¹æ¡ˆï¼Œä¾‹å¦‚é˜¿é‡Œå·´å·´å¼€æºçš„ Hiactorï¼š(<a href="https://github.com/alibaba/hiactor" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/hiactor</a>)ã€‚ä¸è¿‡ï¼Œæœ€å¹¿ä¸ºäººçŸ¥çš„ Actor å®ç°æ¥è‡ª Java ç”Ÿæ€ç³»ç»Ÿï¼Œé‚£å°±æ˜¯ Akka å·¥å…·åŒ…ï¼š(<a href="https://akka.io/" target="_blank" rel="noopener noreferrer">https://akka.io/</a>)ã€‚</p>

<p>ä¸ºäº†å±•ç¤º Actor æ¨¡å‹çš„å®é™…åº”ç”¨ï¼Œæ¥çœ‹ä¸€ä¸ªä½¿ç”¨ CAF å®ç°ä¸¤ä¸ª actor ä¹‹é—´ç®€å•èŠå¤©çš„ç¤ºä¾‹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°† actor çš„è¡Œä¸ºå®šä¹‰ä¸º Lambda è¡¨è¾¾å¼ï¼Œå®ä¾‹åŒ–ä¸¤ä¸ªç”¨äºèŠå¤©çš„ actorï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´å‘é€æ¶ˆæ¯ã€‚æ¯ä¸ª actor åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯åä¼šå°†å…¶å†…å®¹è¾“å‡ºåˆ°æ§åˆ¶å°ï¼š</p>

</li><pre><code class="language-cpp">behavior chatter(event_based_actor* self, const string&amp; name) {
  return {
    [=] (const string&amp; msg) {
      cout &lt;&lt; name &lt;&lt; &quot; received: &quot; &lt;&lt; msg &lt;&lt; endl;
    }
  };
}
void caf_main(actor_system&amp; system) {
  auto alice = system.spawn(chatter, &quot;Alice&quot;);
  auto bob = system.spawn(chatter, &quot;Bob&quot;);
  scoped_actor self{system};
  self-&gt;send(alice, &quot;Hello Alice!&quot;);
  self-&gt;send(bob, &quot;Hello Bob!&quot;);
  self-&gt;send(alice, &quot;How are you?&quot;);
  self-&gt;send(bob, &quot;I&#39;m good, thanks!&quot;);
  sleep_for(seconds(1));
}
CAF_MAIN()</code></pre>

<p>è¿è¡Œè¿™æ®µä»£ç ä¼šäº§ç”Ÿä¸åŒçš„è¾“å‡ºã€‚æœ€ç†æƒ³çš„ç»“æœæ­£æ˜¯æˆ‘ä»¬æ‰€é¢„æœŸçš„ï¼š</p>

<pre><code class="language-shell">Bob received: Hello Bob!
Alice received: Hello Alice!
Alice received: How are you?
Bob received: I'm good, thanks!</code></pre>

<p>ä½†åå¤è¿è¡Œè¿™æ®µä»£ç ä¼šäº§ç”Ÿä¸åŒçš„ç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<pre><code class="language-shell">Bob received: Hello Bob!
Bob received: I'm good, thanks!
Alice received: Hello Alice!
Alice received: How are you?</code></pre>

<p>è¿˜å¯èƒ½å¾—åˆ°æ›´ç³Ÿç³•çš„è¾“å‡ºç»“æœï¼š</p>

<pre><code class="language-shell">Alice received: Hello Alice!
BobAlice received: How are you? received: Hello Bob!

<p>Bob received: I'm good, thanks!</code></pre></p>

<p>è¿™äº›ç»“æœæ¸…æ¥šåœ°è¡¨æ˜ï¼Œactor æ˜¯çœŸæ­£å¹¶è¡Œè¿è¡Œçš„ã€‚åŒæ—¶ï¼Œå®ƒä»¬ä¹Ÿæ­ç¤ºäº†ä¸€ä¸ªç°å®ï¼šå°½ç®¡æ¡†æ¶åœ¨åº•å±‚åšäº†å¤§é‡å°è£…ï¼Œå¹¶è¡Œç¼–ç¨‹çš„å¤æ‚æ€§ç»ˆç©¶æ— æ³•è¢«å®Œå…¨éšè—ã€‚æˆ‘ä»¬ä»ç„¶éœ€è¦ç†è§£æ¶ˆæ¯ä¼ é€’ã€çŠ¶æ€åŒæ­¥ä»¥åŠæ½œåœ¨çš„å¹¶å‘é—®é¢˜ï¼Œåªæ˜¯è¿™äº›é—®é¢˜ç°åœ¨ä»¥æ›´é«˜å±‚æ¬¡çš„å½¢å¼å‘ˆç°å‡ºæ¥ã€‚</p>

<p>ä¸è¿‡ï¼ŒActor æ¨¡å‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¼ºå¤§çš„æŠ½è±¡æ–¹å¼ â€”â€” å®ƒè®©æˆ‘ä»¬å°†å¹¶è¡Œç¼–ç¨‹çœ‹ä½œæ˜¯ä¸€ç»„ç‹¬ç«‹å¯¹è±¡å¯¹è¯·æ±‚åšå‡ºå“åº”çš„è¿‡ç¨‹ã€‚è¿™ç§æ¨¡å‹ä¸ä»…æ›´è´´è¿‘ç°å®ä¸–ç•Œçš„è¿ä½œæ–¹å¼ï¼Œè¿˜å…è®¸æˆ‘ä»¬æ ¹æ®ç³»ç»Ÿéœ€æ±‚çµæ´»é€‰æ‹© actor çš„ç±»å‹å’Œé€šä¿¡æœºåˆ¶ã€‚å‰é¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªåŸºäºäº‹ä»¶ã€æ¥æ”¶å¼‚æ­¥æ¶ˆæ¯çš„ actorï¼Œä½†è®¸å¤šæ¡†æ¶ï¼ˆå¦‚ CAFï¼‰åŒæ ·æ”¯æŒé˜»å¡å¼æ¶ˆæ¯ä¼ é€’ï¼Œä»¥åŠå…·æœ‰ä¸åŒç”Ÿå‘½å‘¨æœŸçš„ actor ç±»å‹ã€‚</p>

<p>Actor æ¨¡å‹çš„ä¸€å¤§ä¼˜åŠ¿åœ¨äºå…¶å¤©ç„¶çš„å¯æ‰©å±•æ€§ã€‚æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°† actor åˆ†å¸ƒåœ¨ä¸åŒçš„è®¡ç®—èŠ‚ç‚¹ä¸Šï¼Œä»è€Œæ„å»ºå‡ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚è¿™æ„å‘³ç€ï¼Œä»ç¬¬ä¸€è¡Œä»£ç å¼€å§‹ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±å…·å¤‡äº†æ¨ªå‘æ‰©å±•çš„èƒ½åŠ›ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬ç«‹åˆ»é¢å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…¸å‹æŒ‘æˆ˜ï¼Œä¾‹å¦‚ç½‘ç»œå»¶è¿Ÿã€èŠ‚ç‚¹æ•…éšœã€æ•°æ®ä¸€è‡´æ€§ç­‰é—®é¢˜ã€‚</p>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†ç°ä»£ C++ æ ‡å‡†åº“æ‰€æä¾›çš„å¹¶å‘æ”¯æŒï¼Œä»¥åŠç»è¿‡å®è·µéªŒè¯çš„ Actor æ¨¡å‹æ‰€èƒ½å®ç°çš„åŠŸèƒ½ã€‚ç„¶è€Œï¼Œåœ¨é¢å¯¹æ—¥ç›Šå¤æ‚çš„è½¯ä»¶éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬ä»ä¼šé‡åˆ°ä¸€äº›å½“å‰è¯­è¨€å’Œæ ‡å‡†å°šæœªåŸç”Ÿæ”¯æŒçš„åœºæ™¯ã€‚é‚£ä¹ˆï¼Œåˆ°åº•è¿˜æœ‰å“ªäº›èƒ½åŠ›æ˜¯æˆ‘ä»¬ç›®å‰æ— æ³•è½»æ˜“å®ç°çš„ï¼Ÿè¿™æ­£æ˜¯ä¸‹ä¸€èŠ‚è¦æ¢è®¨çš„é‡ç‚¹ã€‚</p>
          </section>
          
  <div class="navigation">
    <a href="74--chapter7-4.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š7.4. å‡½æ•°å¼ç¼–ç¨‹çš„æ•‘æ´</a>
    <a href="76--chapter7-6.html" class="next-link">ä¸‹ä¸€ç« ï¼š7.6. æˆ‘ä»¬çš„èƒ½åŠ›è¾¹ç•Œ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
        </div>
        
    </div>
    
    <!-- å…ˆåŠ è½½æ ¸å¿ƒåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- åŠ è½½MathJax -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>
    
    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // åˆ›å»ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      const themeToggle = document.createElement('button');
      themeToggle.className = 'theme-toggle';
      themeToggle.setAttribute('aria-label', 'åˆ‡æ¢ä¸»é¢˜');
      themeToggle.innerHTML = 'ğŸŒ“';
      document.body.appendChild(themeToggle);
      
      // æ·»åŠ æ·±è‰²å’Œæµ…è‰²ä¸»é¢˜çš„æ ·å¼
      const darkThemeStyle = document.createElement('style');
      const lightThemeStyle = document.createElement('style');
      
      darkThemeStyle.textContent = `
        body.dark-theme {
          --background-color: #1a1a1a;
          --text-color: #e6e6e6;
          --code-bg-color: #2d2d2d;
          --link-color: #58a6ff;
          --highlight-color: #58a6ff;
          --border-color: #333;
          --table-border-color: #444;
          --table-header-bg: #2d2d2d;
          --blockquote-color: #aaa;
          --blockquote-border: #444;
          --part-header-bg: #222;
          --footer-text-color: #aaa;
          --filename-bg: #2d2d2d;
          --nav-bg: #2d2d2d;
          --nav-hover-bg: #444;
          --toc-bg: #222;
          --highlight-section-bg: #2d2d2d;
          --highlight-section-border: #58a6ff;
        }
      `;
      
      lightThemeStyle.textContent = `
        body.light-theme {
          --background-color: #ffffff;
          --text-color: #333333;
          --code-bg-color: #f5f5f5;
          --link-color: #0366d6;
          --highlight-color: #0366d6;
          --border-color: #eee;
          --table-border-color: #ddd;
          --table-header-bg: #f2f2f2;
          --blockquote-color: #666;
          --blockquote-border: #ddd;
          --part-header-bg: #f8f8f8;
          --footer-text-color: #666;
          --filename-bg: #f5f5f5;
          --nav-bg: #f5f5f5;
          --nav-hover-bg: #e6e6e6;
          --toc-bg: #f8f8f8;
          --highlight-section-bg: #f8f8f8;
          --highlight-section-border: #0366d6;
        }
      `;
      
      document.head.appendChild(darkThemeStyle);
      document.head.appendChild(lightThemeStyle);
      
      // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è®¾ç½®
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      const currentTheme = localStorage.getItem('theme');
      
      if (currentTheme === 'dark') {
        document.body.classList.add('dark-theme');
      } else if (currentTheme === 'light') {
        document.body.classList.add('light-theme');
      } else {
        // å¦‚æœæ²¡æœ‰ä¿å­˜çš„åå¥½ï¼Œè·Ÿéšç³»ç»Ÿ
        if (prefersDarkScheme.matches) {
          document.body.classList.add('dark-theme');
        } else {
          document.body.classList.add('light-theme');
        }
      }
      
      // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
      themeToggle.addEventListener('click', function() {
        console.log('Theme toggle clicked');
        if (document.body.classList.contains('dark-theme')) {
          document.body.classList.remove('dark-theme');
          document.body.classList.add('light-theme');
          localStorage.setItem('theme', 'light');
        } else {
          document.body.classList.remove('light-theme');
          document.body.classList.add('dark-theme');
          localStorage.setItem('theme', 'dark');
        }
      });
      
      // ç¡®ä¿ä»£ç å—æœ‰æ­£ç¡®çš„ç±»å
      document.querySelectorAll('pre code').forEach(function(block) {
        if (!block.className && block.parentNode.innerHTML.includes('cpp')) {
          block.className = 'language-cpp';
        } else if (!block.className && block.parentNode.innerHTML.includes('rust')) {
          block.className = 'language-rust';
        } else if (!block.className) {
          block.className = 'language-plaintext';
        }
      });
      
      // å»¶è¿ŸåŠ è½½Prismé«˜äº®
      setTimeout(function() {
        if (window.Prism) {
          window.Prism.highlightAll();
        }
      }, 500);
    });
    </script>
  </body>
  </html>
  