
  <!DOCTYPE html>
  <html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.5. å¤´æ–‡ä»¶ä¸ç¬¦åˆC++è§„èŒƒæ—¶ - èµ°å‡ºC++è°œäº‘</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <script>
      window.MathJax = {"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]],"processEscapes":true,"tags":"ams"},"svg":{"fontCache":"global"}};
    </script>
    
  </head>
  <body>
    <div class="container">
      
        <div class="chapter-container">
          
  <div class="navigation">
    <a href="24--chapter2-4.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š2.4. è‡ªç”±çš„ç¼–è¯‘å™¨</a>
    <a href="26--chapter2-6.html" class="next-link">ä¸‹ä¸€ç« ï¼š2.6. é²œä¸ºäººçŸ¥çš„é‚£äº›äº‹ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
          <section id="25-c-chapter2-5" class="section">
            <h2 class="section-title">2.5. å¤´æ–‡ä»¶ä¸ç¬¦åˆC++è§„èŒƒæ—¶</h2>
            <p>å‰é¢æ‰€å±•ç¤ºçš„é‚£äº›éæ ‡å‡†ä½†ä»ç„¶å¯ç”¨ä¸”éå¸¸å®ç”¨çš„åŠŸèƒ½åˆ—è¡¨è¿œæœªç»“æŸã€‚å¦‚æœæˆ‘ä»¬æŠŠæ³¨æ„åŠ›å®Œå…¨é›†ä¸­åœ¨è¿™äº›æ‰©å±•ä¸Šï¼Œç”šè‡³å¯ä»¥ç”¨å®ƒä»¬å†™å¥½å‡ æœ¬ä¹¦ã€‚å¯æƒœçš„æ˜¯ï¼Œæˆ‘ä»¬ç›®å‰åªå®‰æ’äº†ä¸€ç« æ¥è®¨è®ºè¿™ä¸ªè¯é¢˜ã€‚å†å°†è§†çº¿è½¬å‘ä¸€äº›æ›´ä¸ºç‹¬ç‰¹ã€æ›´å…·â€œé£å‘³â€çš„åŠŸèƒ½ã€‚</p>

<p>Qt é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯ä¸€ä¸ªç”¨äºæ„å»º GUI åº”ç”¨ç¨‹åºï¼ˆè€Œä¸ä»…ä»…æ˜¯ GUIï¼‰çš„è·¨å¹³å°ç¼–ç¨‹æ¡†æ¶ã€‚è‡ª 1994 å¹´è¯ç”Ÿä»¥æ¥ï¼ŒQt ç»å†äº†å¤šæ¬¡æ‰€æœ‰æƒå˜æ›´ï¼Œä½†åœ¨å…¶æ³¢æ¾œèµ·ä¼çš„å‘å±•å†ç¨‹ä¸­ä¸æ–­æˆé•¿ï¼Œæ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½ä¸º C++ï¼ˆä»¥åŠå…¶å®ƒè¯­è¨€ï¼‰å¼€å‘è€…å¸¦æ¥äº†æ–°çš„å·¥å…·å’Œç‰¹æ€§ã€‚</p>

<p>ç„¶è€Œï¼Œæœ‰ä¸€é¡¹æ ¸å¿ƒåŠŸèƒ½å‡ ä¹ä»æœªæ”¹å˜ï¼šä¿¡å·/æ§½æœºåˆ¶ï¼ˆSignals and Slotsï¼‰ï¼Œä»¥åŠæ”¯æ’‘å®ƒçš„ Meta Object Compilerï¼ˆMOCï¼‰ã€‚ä½œä¸º Qt çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼ŒMOC èƒ½å¤Ÿå°†äº‹ä»¶ä»ä¸€ä¸ªç»„ä»¶ï¼ˆå³â€œä¿¡å·â€ï¼‰è¿æ¥åˆ°å¦ä¸€ä¸ªæ¥æ”¶è€…ï¼ˆå³â€œæ’æ§½â€ï¼‰ï¼Œä»è€Œå®ç°æ¨¡å—ä¹‹é—´çš„é€šä¿¡ã€‚</p>

<p>ä½†è¿™ä¸€å¼ºå¤§åŠŸèƒ½çš„èƒŒåï¼Œæ˜¯ä»¥ç‰ºç‰²éƒ¨åˆ†æ ‡å‡† C++ ç»“æ„ä¸ºä»£ä»·çš„ã€‚ä¸ºäº†ä½¿è¿™ç§å¯¹è±¡é—´çš„åŠ¨æ€è¿æ¥æˆä¸ºå¯èƒ½ï¼ŒQt å¼•å…¥äº†ä¸€äº›éæ ‡å‡†çš„è¯­æ³•å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</p>

<ul>
    <li>ç±»å£°æ˜ä¸­æ–°å¢äº†å¦‚ signals: å’Œ private slots: è¿™æ ·çš„è®¿é—®ä¿®é¥°ç¬¦
  
  </li>  <li>å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å…³é”®å­— emitï¼Œç”¨äºæ˜¾å¼å‘å‡ºä¿¡å·
</ul>

<p>ä¸‹é¢æ˜¯ä¸€æ®µå…¸å‹çš„ Qt å¤´æ–‡ä»¶ç¤ºä¾‹ï¼Œå®ƒä½¿å¾—åç»­ä»£ç èƒ½å¤ŸæˆåŠŸç¼–è¯‘å¹¶è¿è¡Œï¼š</p>

</li><pre><code class="language-cpp">#ifndef MYCONTROL_H
#define MYCONTROL_H
#include &lt;QObject&gt;
#include &lt;QPushButton&gt;
#include &lt;QWidget&gt;
class MyControl : public QWidget {
  Q_OBJECT
public:
  MyControl(QWidget *parent = nullptr);
private slots:
  void onButtonClicked();
signals:
  void nameChanged(const QString &amp;name);
private:
  QPushButton *myButton;
};
#endif</code></pre>

<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šæˆ‘ä»¬æ˜¯å¦åº”è¯¥æ¥å— Qt æä¾›çš„ä¾¿åˆ©æ€§ï¼Œä½¿ç”¨è¿™å¥—éå¸¸å¼ºå¤§çš„ä¿¡å·/æ§½æœºåˆ¶ï¼Œå³ä½¿å¿…é¡»ç¼–å†™éæ ‡å‡†çš„ C++ ä»£ç ï¼Ÿè¿˜æ˜¯åº”è¯¥åšæŒä¼ ç»Ÿæ–¹å¼ï¼Œé€šè¿‡çº¯æ ‡å‡† C++ å®ç°æ¯ä¸ªæŒ‰é’®å’Œäº‹ä»¶ç»‘å®šï¼Œå°±åƒåœ¨ GTK ä¸­æ‰€åšçš„é‚£æ ·ï¼Ÿ</p>

<p>è¿™ä¸ªé—®é¢˜è¶…å‡ºäº†æœ¬ç« æ‰€èƒ½å›ç­”çš„èŒƒå›´ã€‚æœ€ç»ˆçš„å†³å®šå–å†³äºé¡¹ç›®çš„å…·ä½“éœ€æ±‚ï¼šåŒ…æ‹¬ç›®æ ‡ç¯å¢ƒçš„æŠ€æœ¯é™åˆ¶ã€é¡¹ç›®åˆ©ç›Šç›¸å…³è€…å¯¹å¹³å°çš„æœŸæœ›ï¼Œä»¥åŠå¼€å‘å›¢é˜Ÿè‡ªèº«çš„åå¥½å’ŒæŠ€æœ¯æ ˆã€‚</p>

<p>ä¸è¿‡ï¼Œè¯·ä¸è¦å› ä¸ºè¿™äº›ä»£ç çœ‹èµ·æ¥ä¸åƒæ˜¯æ ‡å‡† C++ å°±æ„Ÿåˆ°ä¸å®‰ã€‚å°½ç®¡ç¡®å®åç¦»äº†è§„èŒƒï¼Œä½†å®ƒä»¬è§£å†³çš„æ˜¯çœŸå®ä¸–ç•Œä¸­çš„å®é™…é—®é¢˜ã€‚åœ¨èƒŒåï¼Œéšè—ç€ä¸€å¥—ç»è¿‡éªŒè¯ã€ä¼˜åŒ–å¹¶åœ¨å¤šä¸ªå¤§å°é¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨çš„æˆç†Ÿå®ç°æœºåˆ¶ï¼Œå…¶å·²ç»ç»å—ä½äº†æ—¶é—´çš„è€ƒéªŒã€‚</p>

<p>å¦ä¸€æ–¹é¢ï¼ŒMicrosoft å¯¹ C++ çš„å¤§è§„æ¨¡æ‰©å±•åˆ™é‡‡å–äº†æˆªç„¶ä¸åŒçš„è·¯å¾„ã€‚</p>

<p>C++/CLI å¹¶ä¸åƒ Qt çš„ MOC é‚£æ ·æ˜¯ä¸€ä¸ªç‰¹å®šäºæ¡†æ¶çš„å·¥å…·ï¼Œè€Œæ˜¯å¯¹ C++ è¯­è¨€æœ¬èº«çš„æ‰©å±•ï¼Œä¸“é—¨ç”¨äºæ”¯æŒ .NET å¹³å°ã€‚Visual Studio ä¸­ç”¨äº C++/CLI çš„ç¼–è¯‘å™¨ï¼ˆåŸºäºå…¬å…±è¯­è¨€åŸºç¡€ç»“æ„ï¼Œè€Œéä¼ ç»Ÿçš„å‘½ä»¤è¡Œæ¥å£ï¼‰èƒ½å¤Ÿè§£æè¿™äº›æ‰©å±•è¯­æ³•ï¼Œå¹¶ç”Ÿæˆæœ‰æ•ˆçš„ä¸­é—´è¯­è¨€ï¼ˆMSILï¼‰å’Œæœ¬åœ°ä»£ç ã€‚</p>

<p>ä¸‹é¢æ˜¯ä¸€æ®µå…¸å‹çš„ C++/CLI ç¤ºä¾‹ä»£ç ã€‚è™½ç„¶å†…å®¹ç®€å• â€”â€” åªæ˜¯æ‹¼æ¥å­—ç¬¦ä¸²æ•°ç»„å¹¶è¾“å‡ºç»“æœï¼Œä½†å®ƒå±•ç¤ºäº†æ‰˜ç®¡ C++ çš„é£æ ¼ï¼š</p>

<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;atlstr.h&gt;
#include &lt;stdio.h&gt;
using namespace System;
int main() {
  array&lt;String^&gt;^ args = { &quot;managed&quot;, &quot;world&quot; };
  String^ s = &quot;Hello&quot;;
  for each (String ^ a in args) s += &quot; &quot; + a ;
  CString cs(s);
  wprintf(cs);
}</code></pre>

<p>è¿™æ®µä»£ç ç»ä¸æ˜¯æ ‡å‡† C++ã€‚å®ƒçœ‹èµ·æ¥ä¸åƒæ ‡å‡† C++ï¼Œè¡Œä¸ºä¹Ÿä¸åƒï¼Œç”šè‡³è¯­æ³•ä¹Ÿæ ¼æ ¼ä¸å…¥ã€‚å®ƒæ˜¾ç„¶ä¸å±äº ISO C++ çš„èŒƒç•´ã€‚</p>

<p>é‚£ä¹ˆï¼Œå¦‚æœè¦ç”¨æ ‡å‡† C++ æ¥å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>

<pre><code class="language-cpp">#include &lt;array&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
int main() {
  std::array&lt;std::string, 2&gt; args = { &quot;unmanaged&quot;, &quot;world&quot; };
  std::string s = &quot;Hello&quot;;
  for(const auto&amp; a : args) {
    s += &quot; &quot; + a ;
  }
  std::cout &lt;&lt; s;
}</code></pre>

<p>è¿™ä¸ä»…æ›´ç®€æ´ã€æ›´ç°ä»£ï¼Œè€Œä¸”å®Œå…¨ç¬¦åˆ C++ æ ‡å‡†ã€‚å®ƒæ˜¯ä¸æ˜¯æ¯”å‰ä¸€ç§å†™æ³•æ›´æ¸…æ™°ã€æ›´æ˜“ç»´æŠ¤å‘¢ï¼Ÿ</p>

<p>æœªæ¥ï¼Œè§‚å¯Ÿ C++ æ‰˜ç®¡æ‰©å±•ï¼ˆå¦‚ C++/CLIï¼‰çš„å‘å±•å°†ä¼šæ˜¯ä¸€ä»¶å¾ˆæœ‰è¶£çš„äº‹æƒ…ã€‚</p>

<p>ç›®å‰ï¼Œå®ƒå……å½“äº†åŸç”Ÿä»£ç ä¸æ‰˜ç®¡ä»£ç ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹å°ä¼—çš„é¢†åŸŸã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œå®ƒçš„å‘½è¿å°†å–å†³äºå¼€å‘è€…ç¤¾åŒºçš„æ¥å—ç¨‹åº¦ã€æ˜¯å¦æœ‰è¶³å¤Ÿçš„ç”Ÿæ€ç³»ç»Ÿæ”¯æŒï¼Œä»¥åŠæ˜¯å¦æœ‰å…¶ä»–æŠ€æœ¯ï¼ˆå¦‚ P/Invoke æˆ– COM Interopï¼‰é€æ­¥å–ä»£å®ƒæ‰€æ‰¿æ‹…çš„è§’è‰²ã€‚</p>

<p>æ¯«æ— ç–‘é—®ï¼Œæœªæ¥å……æ»¡äº†å˜é©ã€‚</p>
          </section>
          
  <div class="navigation">
    <a href="24--chapter2-4.html" class="prev-link">Â« ä¸Šä¸€ç« ï¼š2.4. è‡ªç”±çš„ç¼–è¯‘å™¨</a>
    <a href="26--chapter2-6.html" class="next-link">ä¸‹ä¸€ç« ï¼š2.6. é²œä¸ºäººçŸ¥çš„é‚£äº›äº‹ Â»</a>
  </div>
  <div class="back-to-toc"><a href="index.html">è¿”å›ç›®å½•</a></div>
  
        </div>
        
    </div>
    
    <!-- å…ˆåŠ è½½æ ¸å¿ƒåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <!-- åŠ è½½MathJax -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>
    
    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // åˆ›å»ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      const themeToggle = document.createElement('button');
      themeToggle.className = 'theme-toggle';
      themeToggle.setAttribute('aria-label', 'åˆ‡æ¢ä¸»é¢˜');
      themeToggle.innerHTML = 'ğŸŒ“';
      document.body.appendChild(themeToggle);
      
      // æ·»åŠ æ·±è‰²å’Œæµ…è‰²ä¸»é¢˜çš„æ ·å¼
      const darkThemeStyle = document.createElement('style');
      const lightThemeStyle = document.createElement('style');
      
      darkThemeStyle.textContent = `
        body.dark-theme {
          --background-color: #1a1a1a;
          --text-color: #e6e6e6;
          --code-bg-color: #2d2d2d;
          --link-color: #58a6ff;
          --highlight-color: #58a6ff;
          --border-color: #333;
          --table-border-color: #444;
          --table-header-bg: #2d2d2d;
          --blockquote-color: #aaa;
          --blockquote-border: #444;
          --part-header-bg: #222;
          --footer-text-color: #aaa;
          --filename-bg: #2d2d2d;
          --nav-bg: #2d2d2d;
          --nav-hover-bg: #444;
          --toc-bg: #222;
          --highlight-section-bg: #2d2d2d;
          --highlight-section-border: #58a6ff;
        }
      `;
      
      lightThemeStyle.textContent = `
        body.light-theme {
          --background-color: #ffffff;
          --text-color: #333333;
          --code-bg-color: #f5f5f5;
          --link-color: #0366d6;
          --highlight-color: #0366d6;
          --border-color: #eee;
          --table-border-color: #ddd;
          --table-header-bg: #f2f2f2;
          --blockquote-color: #666;
          --blockquote-border: #ddd;
          --part-header-bg: #f8f8f8;
          --footer-text-color: #666;
          --filename-bg: #f5f5f5;
          --nav-bg: #f5f5f5;
          --nav-hover-bg: #e6e6e6;
          --toc-bg: #f8f8f8;
          --highlight-section-bg: #f8f8f8;
          --highlight-section-border: #0366d6;
        }
      `;
      
      document.head.appendChild(darkThemeStyle);
      document.head.appendChild(lightThemeStyle);
      
      // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è®¾ç½®
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      const currentTheme = localStorage.getItem('theme');
      
      if (currentTheme === 'dark') {
        document.body.classList.add('dark-theme');
      } else if (currentTheme === 'light') {
        document.body.classList.add('light-theme');
      } else {
        // å¦‚æœæ²¡æœ‰ä¿å­˜çš„åå¥½ï¼Œè·Ÿéšç³»ç»Ÿ
        if (prefersDarkScheme.matches) {
          document.body.classList.add('dark-theme');
        } else {
          document.body.classList.add('light-theme');
        }
      }
      
      // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
      themeToggle.addEventListener('click', function() {
        console.log('Theme toggle clicked');
        if (document.body.classList.contains('dark-theme')) {
          document.body.classList.remove('dark-theme');
          document.body.classList.add('light-theme');
          localStorage.setItem('theme', 'light');
        } else {
          document.body.classList.remove('light-theme');
          document.body.classList.add('dark-theme');
          localStorage.setItem('theme', 'dark');
        }
      });
      
      // ç¡®ä¿ä»£ç å—æœ‰æ­£ç¡®çš„ç±»å
      document.querySelectorAll('pre code').forEach(function(block) {
        if (!block.className && block.parentNode.innerHTML.includes('cpp')) {
          block.className = 'language-cpp';
        } else if (!block.className && block.parentNode.innerHTML.includes('rust')) {
          block.className = 'language-rust';
        } else if (!block.className) {
          block.className = 'language-plaintext';
        }
      });
      
      // å»¶è¿ŸåŠ è½½Prismé«˜äº®
      setTimeout(function() {
        if (window.Prism) {
          window.Prism.highlightAll();
        }
      }, 500);
    });
    </script>
  </body>
  </html>
  